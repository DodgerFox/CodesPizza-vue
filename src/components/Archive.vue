<template>
    <section class="history">
				<div class="wrap">
					<div class="history-body">
						<div class="history-block" >
							<p class="history-date">26.02.2020</p>
							<ul class="history-items">
								<li class="history-item">
									<p class="history-item__code used">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code used">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code used">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
							</ul>
						</div>
						<div class="history-block">
							<p class="history-date">22.02.2020</p>
							<ul class="history-items">
								<li class="history-item">
									<p class="history-item__code used">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code used">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code used">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
							</ul>
						</div>
						<div class="history-block">
							<p class="history-date">17.02.2020</p>
							<ul class="history-items">
								<li class="history-item">
									<p class="history-item__code used">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code used">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code used">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
							</ul>
						</div>
						<div class="history-block">
							<p class="history-date">01.01.2020</p>
							<ul class="history-items">
								<li class="history-item">
									<p class="history-item__code used">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code used">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code used">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
								<li class="history-item">
									<p class="history-item__code added">7F130AB</p>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</section>
</template>

<script>
export default {
	name: 'Archive',
    data: () => ({
        data: '',
        codes: '',
        used: '',
        length: ''
    }),
    async mounted () {        
		this.data = await this.$store.dispatch('fetchCodes')
		console.log(this.data);
		
        const used = [], codes = [], dates = [];
        for (let date in this.data) {
            const block = this.data[date];

            for (let key in block) {
                const array = block[key];

                array.forEach(element => {
                    (!element.status) ? used.push(element) : '';
					codes.push(element);
					if (element.used) {
						const index = dates.indexOf(element.story);
						console.log(index);
						
						if (index) {
							dates[index].push(element)
						}else{
							dates.push(element.story)
							dates[index].push(element)
						}
					}
                });
            } 
        }
        this.codes = codes;
        this.used = used.slice().reverse();
		this.length = used.length;
    },
}
</script>